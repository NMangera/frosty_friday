-- SET DATABASE CONTEXT 
USE DATABASE FF_CHALLENGE;

-- CREATES A LOGICAL GROUPING WITHIN DB
CREATE OR REPLACE SCHEMA WEEK_72;

-- SET  SCHEMA CONTEXT
USE SCHEMA WEEK_72;

-- CREATES TABLE WITH SPECIFIED COLUMNS
CREATE TABLE WEEK72_EMPLOYEES (
    EMPLOYEEID INT,   
    FIRSTNAME STRING, 
    LASTNAME STRING,  
    DATEOFBIRTH DATE, 
    POSITION STRING   
);

-- CREATES STAGE FOR DATA LOADING 
CREATE OR REPLACE STAGE FF_STAGEWK72
URL = 'S3://FROSTYFRIDAYCHALLENGES';

-- DISPLAY CONTENTS OF THE STAGE
LIST @FF_STAGEWK72;

-- EXECUTES AN SQL SCRIPT NAMED 'INSERT.SQL' LOCATED IN THE SPECIFIED PATH
EXECUTE IMMEDIATE FROM @FF_STAGEWK72/CHALLENGE_72/INSERT.SQL;

-- DISPLAYS ALLFROM THE TABLE
SELECT * FROM WEEK72_EMPLOYEES;
